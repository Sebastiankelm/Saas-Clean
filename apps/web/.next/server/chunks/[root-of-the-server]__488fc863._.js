module.exports = {

"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/server/lib/incremental-cache/tags-manifest.external.js [external] (next/dist/server/lib/incremental-cache/tags-manifest.external.js, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/lib/incremental-cache/tags-manifest.external.js", () => require("next/dist/server/lib/incremental-cache/tags-manifest.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/node:async_hooks [external] (node:async_hooks, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:async_hooks", () => require("node:async_hooks"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/pg [external] (pg, esm_import)": ((__turbopack_context__) => {
"use strict";

var { a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
const mod = await __turbopack_context__.y("pg");

__turbopack_context__.n(mod);
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, true);}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[project]/apps/web/config/env.ts [middleware] (ecmascript)": ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s({
    "baseUrl": (()=>baseUrl),
    "env": (()=>env),
    "supportedLocaleList": (()=>supportedLocaleList)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$t3$2d$oss$2b$env$2d$nextjs$40$0$2e$10$2e$1_typescript$40$5$2e$8$2e$3_zod$40$3$2e$24$2e$4$2f$node_modules$2f40$t3$2d$oss$2f$env$2d$nextjs$2f$dist$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/@t3-oss+env-nextjs@0.10.1_typescript@5.8.3_zod@3.24.4/node_modules/@t3-oss/env-nextjs/dist/index.js [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/zod@3.24.4/node_modules/zod/lib/index.mjs [middleware] (ecmascript)");
;
;
const supportedLocales = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(1, 'At least one locale is required').transform((value)=>value.split(',').map((locale)=>locale.trim()).filter(Boolean)).pipe(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].array(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(2)).min(1));
const env = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$t3$2d$oss$2b$env$2d$nextjs$40$0$2e$10$2e$1_typescript$40$5$2e$8$2e$3_zod$40$3$2e$24$2e$4$2f$node_modules$2f40$t3$2d$oss$2f$env$2d$nextjs$2f$dist$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["createEnv"])({
    server: {
        SUPABASE_URL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().url(),
        SUPABASE_ANON_KEY: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(1),
        SUPABASE_SERVICE_ROLE_KEY: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(1),
        AUTH_SECRET: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(32),
        STRIPE_SECRET_KEY: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(1),
        STRIPE_WEBHOOK_SECRET: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(1),
        FRONTEND_URL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().url(),
        BASE_URL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().url().optional(),
        CONTACT_EMAIL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().email(),
        I18N_DEFAULT_LOCALE: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(2),
        I18N_SUPPORTED_LOCALES: supportedLocales,
        POSTGRES_URL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().url().optional(),
        POSTGRES_SSL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].enum([
            'true',
            'false'
        ]).optional()
    },
    client: {
        NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$zod$40$3$2e$24$2e$4$2f$node_modules$2f$zod$2f$lib$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__["z"].string().min(1)
    },
    runtimeEnv: {
        SUPABASE_URL: process.env.SUPABASE_URL,
        SUPABASE_ANON_KEY: process.env.SUPABASE_ANON_KEY,
        SUPABASE_SERVICE_ROLE_KEY: process.env.SUPABASE_SERVICE_ROLE_KEY,
        AUTH_SECRET: process.env.AUTH_SECRET,
        STRIPE_SECRET_KEY: process.env.STRIPE_SECRET_KEY,
        STRIPE_WEBHOOK_SECRET: process.env.STRIPE_WEBHOOK_SECRET,
        FRONTEND_URL: process.env.FRONTEND_URL,
        BASE_URL: process.env.BASE_URL,
        CONTACT_EMAIL: process.env.CONTACT_EMAIL,
        I18N_DEFAULT_LOCALE: process.env.I18N_DEFAULT_LOCALE,
        I18N_SUPPORTED_LOCALES: process.env.I18N_SUPPORTED_LOCALES,
        POSTGRES_URL: process.env.POSTGRES_URL,
        POSTGRES_SSL: process.env.POSTGRES_SSL,
        NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
    },
    skipValidation: !!process.env.SKIP_ENV_VALIDATION,
    emptyStringAsUndefined: true
});
const baseUrl = env.BASE_URL ?? env.FRONTEND_URL;
const supportedLocaleList = env.I18N_SUPPORTED_LOCALES;
}),
"[project]/apps/web/lib/db/client.ts [middleware] (ecmascript)": ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s({
    "createSupabaseEdgeClient": (()=>createSupabaseEdgeClient),
    "createSupabaseServerClient": (()=>createSupabaseServerClient),
    "getSupabaseAdminClient": (()=>getSupabaseAdminClient)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$supabase$2b$supabase$2d$js$40$2$2e$76$2e$1$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/@supabase+supabase-js@2.76.1/node_modules/@supabase/supabase-js/dist/module/index.js [middleware] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/web/config/env.ts [middleware] (ecmascript)");
;
;
const supabaseUrl = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["env"].SUPABASE_URL;
const supabaseAnonKey = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["env"].SUPABASE_ANON_KEY;
const supabaseServiceRoleKey = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["env"].SUPABASE_SERVICE_ROLE_KEY;
const globalOptions = {
    auth: {
        persistSession: false,
        autoRefreshToken: false
    }
};
let adminClient = null;
function getSupabaseAdminClient() {
    if (!adminClient) {
        adminClient = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$supabase$2b$supabase$2d$js$40$2$2e$76$2e$1$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseServiceRoleKey, globalOptions);
    }
    return adminClient;
}
function createSupabaseServerClient(accessToken) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$supabase$2b$supabase$2d$js$40$2$2e$76$2e$1$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseAnonKey, {
        ...globalOptions,
        global: {
            headers: accessToken ? {
                Authorization: `Bearer ${accessToken}`
            } : undefined
        }
    });
}
function createSupabaseEdgeClient(accessToken) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f40$supabase$2b$supabase$2d$js$40$2$2e$76$2e$1$2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseAnonKey, {
        ...globalOptions,
        global: {
            headers: {
                ...accessToken ? {
                    Authorization: `Bearer ${accessToken}`
                } : {},
                'x-client-info': 'edge'
            }
        }
    });
}
}),
"[project]/apps/web/lib/db/schema.ts [middleware] (ecmascript)": ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s({
    "ActivityType": (()=>ActivityType)
});
var ActivityType = /*#__PURE__*/ function(ActivityType) {
    ActivityType["SIGN_UP"] = "SIGN_UP";
    ActivityType["SIGN_IN"] = "SIGN_IN";
    ActivityType["SIGN_OUT"] = "SIGN_OUT";
    ActivityType["UPDATE_PASSWORD"] = "UPDATE_PASSWORD";
    ActivityType["DELETE_ACCOUNT"] = "DELETE_ACCOUNT";
    ActivityType["UPDATE_ACCOUNT"] = "UPDATE_ACCOUNT";
    ActivityType["CREATE_TEAM"] = "CREATE_TEAM";
    ActivityType["REMOVE_TEAM_MEMBER"] = "REMOVE_TEAM_MEMBER";
    ActivityType["INVITE_TEAM_MEMBER"] = "INVITE_TEAM_MEMBER";
    ActivityType["ACCEPT_INVITATION"] = "ACCEPT_INVITATION";
    return ActivityType;
}({});
}),
"[project]/apps/web/lib/auth/better.ts [middleware] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
__turbopack_context__.s({
    "auth": (()=>auth),
    "validateSession": (()=>validateSession)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$auth$40$1$2e$3$2e$33_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom_j7qovgj7z77jiozburz7dnllgu$2f$node_modules$2f$better$2d$auth$2f$dist$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/better-auth@1.3.33_next@15.4.0-canary.47_@babel+core@7.28.5_@playwright+test@1.56.1_react-dom_j7qovgj7z77jiozburz7dnllgu/node_modules/better-auth/dist/index.mjs [middleware] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$auth$40$1$2e$3$2e$33_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom_j7qovgj7z77jiozburz7dnllgu$2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B_MIzgm3$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__$3c$export__b__as__betterAuth$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/better-auth@1.3.33_next@15.4.0-canary.47_@babel+core@7.28.5_@playwright+test@1.56.1_react-dom_j7qovgj7z77jiozburz7dnllgu/node_modules/better-auth/dist/shared/better-auth.B_MIzgm3.mjs [middleware] (ecmascript) <export b as betterAuth>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$call$40$1$2e$0$2e$19$2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/better-call@1.0.19/node_modules/better-call/dist/index.js [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$auth$40$1$2e$3$2e$33_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom_j7qovgj7z77jiozburz7dnllgu$2f$node_modules$2f$better$2d$auth$2f$dist$2f$plugins$2f$organization$2f$index$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/better-auth@1.3.33_next@15.4.0-canary.47_@babel+core@7.28.5_@playwright+test@1.56.1_react-dom_j7qovgj7z77jiozburz7dnllgu/node_modules/better-auth/dist/plugins/organization/index.mjs [middleware] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$auth$40$1$2e$3$2e$33_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom_j7qovgj7z77jiozburz7dnllgu$2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$uWoihDRP$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__$3c$export__o__as__organization$3e$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/better-auth@1.3.33_next@15.4.0-canary.47_@babel+core@7.28.5_@playwright+test@1.56.1_react-dom_j7qovgj7z77jiozburz7dnllgu/node_modules/better-auth/dist/shared/better-auth.uWoihDRP.mjs [middleware] (ecmascript) <export o as organization>");
var __TURBOPACK__imported__module__$5b$externals$5d2f$pg__$5b$external$5d$__$28$pg$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/pg [external] (pg, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$kysely$40$0$2e$28$2e$8$2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$postgres$2f$postgres$2d$dialect$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/kysely@0.28.8/node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$client$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/web/lib/db/client.ts [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$schema$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/web/lib/db/schema.ts [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/web/config/env.ts [middleware] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$pg__$5b$external$5d$__$28$pg$2c$__esm_import$29$__
]);
([__TURBOPACK__imported__module__$5b$externals$5d2f$pg__$5b$external$5d$__$28$pg$2c$__esm_import$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__);
;
;
;
;
;
;
;
const databaseUrl = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["env"].POSTGRES_URL;
const authSecret = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["env"].AUTH_SECRET;
const baseUrl = __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["baseUrl"] ?? 'http://localhost:3000';
if (!databaseUrl) {
    throw new Error('POSTGRES_URL is not defined');
}
if (!authSecret) {
    throw new Error('AUTH_SECRET is not defined');
}
const pool = new __TURBOPACK__imported__module__$5b$externals$5d2f$pg__$5b$external$5d$__$28$pg$2c$__esm_import$29$__["Pool"]({
    connectionString: databaseUrl,
    ssl: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$config$2f$env$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["env"].POSTGRES_SSL === 'false' ? false : {
        rejectUnauthorized: false
    }
});
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$client$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["getSupabaseAdminClient"])();
const authInstance = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$auth$40$1$2e$3$2e$33_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom_j7qovgj7z77jiozburz7dnllgu$2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$B_MIzgm3$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__$3c$export__b__as__betterAuth$3e$__["betterAuth"])({
    baseURL: baseUrl,
    secret: authSecret,
    database: {
        dialect: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$kysely$40$0$2e$28$2e$8$2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$postgres$2f$postgres$2d$dialect$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["PostgresDialect"]({
            pool
        }),
        type: 'postgres',
        casing: 'snake'
    },
    emailAndPassword: {
        enabled: true
    },
    user: {
        additionalFields: {
            supabaseId: {
                type: 'number',
                required: false,
                input: false,
                returned: true
            }
        }
    },
    integrations: [],
    plugins: [
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$auth$40$1$2e$3$2e$33_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom_j7qovgj7z77jiozburz7dnllgu$2f$node_modules$2f$better$2d$auth$2f$dist$2f$shared$2f$better$2d$auth$2e$uWoihDRP$2e$mjs__$5b$middleware$5d$__$28$ecmascript$29$__$3c$export__o__as__organization$3e$__["organization"])({
            teams: {
                enabled: true,
                defaultTeam: {
                    enabled: true
                }
            }
        })
    ],
    databaseHooks: {
        account: {
            create: {
                async after (account, ctx) {
                    if (account.providerId !== 'credential') {
                        return;
                    }
                    const requestBody = ctx?.context?.body ?? {};
                    const inviteId = requestBody?.inviteId ? Number(requestBody.inviteId) : undefined;
                    const userRecord = await ctx?.context.internalAdapter.findUserById(account.userId, ctx?.context);
                    if (!userRecord) {
                        return;
                    }
                    const { data: existingUser } = await supabase.from('users').select('*').eq('email', userRecord.email).maybeSingle();
                    if (existingUser) {
                        await ctx?.context.internalAdapter.updateUser(account.userId, {
                            supabaseId: existingUser.id
                        });
                        return;
                    }
                    if (!account.password) {
                        return;
                    }
                    const newUser = {
                        email: userRecord.email,
                        name: userRecord.name ?? null,
                        password_hash: account.password,
                        role: 'owner'
                    };
                    const { data: createdUser, error: createUserError } = await supabase.from('users').insert(newUser).select('*').single();
                    if (createUserError || !createdUser) {
                        console.error('Failed to create Supabase user', createUserError);
                        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$better$2d$call$40$1$2e$0$2e$19$2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["APIError"]('INTERNAL_SERVER_ERROR', {
                            message: 'Failed to create Supabase user'
                        });
                    }
                    if (typeof inviteId === 'number') {
                        await ctx?.context.internalAdapter.updateUser(account.userId, {
                            supabaseId: createdUser.id
                        });
                        return;
                    }
                    const teamPayload = {
                        name: `${userRecord.email}'s Team`
                    };
                    const { data: createdTeam, error: createTeamError } = await supabase.from('teams').insert(teamPayload).select('*').single();
                    if (createTeamError || !createdTeam) {
                        console.error('Failed to create default team', createTeamError);
                        return;
                    }
                    const memberPayload = {
                        team_id: createdTeam.id,
                        user_id: createdUser.id,
                        role: 'owner'
                    };
                    const { error: memberError } = await supabase.from('team_members').insert(memberPayload);
                    if (memberError) {
                        console.error('Failed to create team member', memberError);
                    }
                    await Promise.all([
                        supabase.from('activity_logs').insert({
                            team_id: createdTeam.id,
                            user_id: createdUser.id,
                            action: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$schema$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["ActivityType"].CREATE_TEAM
                        }),
                        supabase.from('activity_logs').insert({
                            team_id: createdTeam.id,
                            user_id: createdUser.id,
                            action: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$schema$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["ActivityType"].SIGN_UP
                        }),
                        supabase.rpc('refresh_team_views'),
                        ctx?.context.internalAdapter.updateUser(account.userId, {
                            supabaseId: createdUser.id
                        })
                    ]);
                }
            }
        },
        session: {
            create: {
                async after (session, ctx) {
                    const user = await ctx?.context.internalAdapter.findUserById(session.userId, ctx?.context);
                    if (!user?.supabaseId) {
                        return;
                    }
                    const { data: membership } = await supabase.from('team_members').select('team_id').eq('user_id', user.supabaseId).maybeSingle();
                    if (!membership?.team_id) {
                        return;
                    }
                    await supabase.from('activity_logs').insert({
                        team_id: membership.team_id,
                        user_id: user.supabaseId,
                        action: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$schema$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["ActivityType"].SIGN_IN
                    });
                }
            },
            delete: {
                async after (session, ctx) {
                    const user = await ctx?.context.internalAdapter.findUserById(session.userId, ctx?.context);
                    if (!user?.supabaseId) {
                        return;
                    }
                    const { data: membership } = await supabase.from('team_members').select('team_id').eq('user_id', user.supabaseId).maybeSingle();
                    if (!membership?.team_id) {
                        return;
                    }
                    await supabase.from('activity_logs').insert({
                        team_id: membership.team_id,
                        user_id: user.supabaseId,
                        action: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$db$2f$schema$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["ActivityType"].SIGN_OUT
                    });
                }
            }
        }
    }
});
const auth = authInstance;
async function validateSession(headersInit) {
    const result = await auth.api.getSession({
        headers: headersInit,
        returnHeaders: true
    });
    return result;
}
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/apps/web/src/i18n/config.ts [middleware] (ecmascript)": ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s({
    "defaultLocale": (()=>defaultLocale),
    "getMessages": (()=>getMessages),
    "locales": (()=>locales)
});
const locales = [
    'en',
    'pl'
];
const defaultLocale = 'en';
const dictionaries = {
    en: ()=>__turbopack_context__.r("[project]/apps/web/src/locales/en/common.json (json, async loader)")(__turbopack_context__.i).then((module)=>module.default),
    pl: ()=>__turbopack_context__.r("[project]/apps/web/src/locales/pl/common.json (json, async loader)")(__turbopack_context__.i).then((module)=>module.default)
};
async function getMessages(locale) {
    const normalizedLocale = locales.includes(locale) ? locale : defaultLocale;
    try {
        return await dictionaries[normalizedLocale]();
    } catch (error) {
        console.warn(`Falling back to default locale due to missing messages for "${locale}"`, error);
        return dictionaries[defaultLocale]();
    }
}
}),
"[project]/apps/web/middleware.ts [middleware] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
__turbopack_context__.s({
    "config": (()=>config),
    "middleware": (()=>middleware)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom$40$19$2e$1$2e$0_react$40$19$2e$1$2e$0_$5f$react$40$19$2e$1$2e$0$2f$node_modules$2f$next$2f$server$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next@15.4.0-canary.47_@babel+core@7.28.5_@playwright+test@1.56.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/server.js [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$2d$intl$40$3$2e$26$2e$5_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom$40$1_u3gklztmp244rnna2d2vkght2q$2f$node_modules$2f$next$2d$intl$2f$dist$2f$middleware$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/.pnpm/next-intl@3.26.5_next@15.4.0-canary.47_@babel+core@7.28.5_@playwright+test@1.56.1_react-dom@1_u3gklztmp244rnna2d2vkght2q/node_modules/next-intl/dist/middleware.js [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$auth$2f$better$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/web/lib/auth/better.ts [middleware] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$src$2f$i18n$2f$config$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/apps/web/src/i18n/config.ts [middleware] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$auth$2f$better$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__
]);
([__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$auth$2f$better$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__);
;
;
;
;
const protectedRoutes = [
    '/dashboard'
];
// Simple in-memory rate limiting store
const rateLimitStore = new Map();
function rateLimit(identifier, limit, windowMs) {
    const now = Date.now();
    const key = identifier;
    // Clean up expired entries
    for (const [k, v] of rateLimitStore.entries()){
        if (v.resetTime < now) {
            rateLimitStore.delete(k);
        }
    }
    const record = rateLimitStore.get(key);
    if (!record || record.resetTime < now) {
        rateLimitStore.set(key, {
            count: 1,
            resetTime: now + windowMs
        });
        return true;
    }
    if (record.count >= limit) {
        return false;
    }
    record.count++;
    return true;
}
const intlMiddleware = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$2d$intl$40$3$2e$26$2e$5_next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom$40$1_u3gklztmp244rnna2d2vkght2q$2f$node_modules$2f$next$2d$intl$2f$dist$2f$middleware$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["default"])({
    locales: [
        ...__TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$src$2f$i18n$2f$config$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["locales"]
    ],
    defaultLocale: __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$src$2f$i18n$2f$config$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["defaultLocale"],
    localePrefix: 'always'
});
function extractPathWithoutLocale(pathname) {
    const segments = pathname.split('/').filter(Boolean);
    if (segments.length === 0) {
        return '/';
    }
    segments.shift();
    return `/${segments.join('/')}`;
}
function resolveLocaleFromPath(pathname) {
    const segment = pathname.split('/').filter(Boolean)[0];
    if (segment && __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$src$2f$i18n$2f$config$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["locales"].includes(segment)) {
        return segment;
    }
    return __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$src$2f$i18n$2f$config$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["defaultLocale"];
}
async function middleware(request) {
    const pathname = request.nextUrl.pathname;
    const clientId = request.ip || request.headers.get('x-forwarded-for') || 'unknown';
    // Apply rate limiting for API routes
    if (pathname.startsWith('/api/')) {
        const isAuthRoute = pathname.includes('/auth') || pathname.includes('/sign-in') || pathname.includes('/sign-up');
        const limit = isAuthRoute ? 20 : 100; // 20 req/min for auth, 100 req/min for other API
        const windowMs = 60 * 1000; // 1 minute
        if (!rateLimit(clientId, limit, windowMs)) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom$40$19$2e$1$2e$0_react$40$19$2e$1$2e$0_$5f$react$40$19$2e$1$2e$0$2f$node_modules$2f$next$2f$server$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Too many requests'
            }, {
                status: 429,
                headers: {
                    'Retry-After': '60'
                }
            });
        }
    }
    const intlResponse = intlMiddleware(request);
    if (intlResponse.headers.has('location')) {
        return intlResponse;
    }
    const locale = resolveLocaleFromPath(pathname);
    const normalizedPath = extractPathWithoutLocale(pathname);
    const isProtectedRoute = protectedRoutes.some((route)=>normalizedPath.startsWith(route));
    let sessionHeaders = null;
    let sessionPayload = null;
    try {
        const sessionResult = await __TURBOPACK__imported__module__$5b$project$5d2f$apps$2f$web$2f$lib$2f$auth$2f$better$2e$ts__$5b$middleware$5d$__$28$ecmascript$29$__["auth"].api.getSession({
            headers: request.headers,
            returnHeaders: true
        });
        sessionHeaders = sessionResult?.headers ?? null;
        sessionPayload = sessionResult?.response ?? sessionResult ?? null;
    } catch (error) {
        console.error('Failed to validate session via Better Auth', error);
    }
    const hasSession = Boolean(sessionPayload?.session);
    if (isProtectedRoute && !hasSession) {
        const redirectUrl = new URL(`/${locale}/sign-in`, request.url);
        const redirectResponse = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom$40$19$2e$1$2e$0_react$40$19$2e$1$2e$0_$5f$react$40$19$2e$1$2e$0$2f$node_modules$2f$next$2f$server$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["NextResponse"].redirect(redirectUrl);
        const setCookieHeader = sessionHeaders?.get('set-cookie');
        if (setCookieHeader) {
            redirectResponse.headers.set('set-cookie', setCookieHeader);
        }
        return redirectResponse;
    }
    const response = intlResponse ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f2e$pnpm$2f$next$40$15$2e$4$2e$0$2d$canary$2e$47_$40$babel$2b$core$40$7$2e$28$2e$5_$40$playwright$2b$test$40$1$2e$56$2e$1_react$2d$dom$40$19$2e$1$2e$0_react$40$19$2e$1$2e$0_$5f$react$40$19$2e$1$2e$0$2f$node_modules$2f$next$2f$server$2e$js__$5b$middleware$5d$__$28$ecmascript$29$__["NextResponse"].next();
    const setCookieHeader = sessionHeaders?.get('set-cookie');
    if (setCookieHeader) {
        response.headers.set('set-cookie', setCookieHeader);
    }
    return response;
}
const config = {
    matcher: [
        '/((?!api|_next/static|_next/image|favicon.ico|site.webmanifest|robots.txt).*)'
    ],
    runtime: 'nodejs'
};
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__488fc863._.js.map